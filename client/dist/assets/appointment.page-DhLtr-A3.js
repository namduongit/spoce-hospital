import{u as D,r,j as e}from"./index-wOwRfMo4.js";import{a as S,d as C}from"./status.constant-BZ6KLHNH.js";import{A as L}from"./appointment.table-BFkSm5Id.js";import{g as E}from"./appointment.service-pkTqRrMy.js";import{g as T}from"./department.service-9tPTb8oj.js";import{g as _}from"./room.service-B3xNNr7b.js";import{g as R}from"./doctor.service-COjR-jbU.js";import"./pagination-DByYZh53.js";import"./appointment.detail-DTfmW0OU.js";import"./format-date.util-D8g88DXU.js";const z=()=>{const{execute:o}=D(),[n,p]=r.useState([]),[x,c]=r.useState([]),[h,u]=r.useState([]),[g,f]=r.useState([]),[b,j]=r.useState([]),[a,N]=r.useState({input:"",status:"",date:""}),d=(s,t)=>{N(l=>({...l,[s]:t}))},m=async()=>{const s=await o(E());if(s?.result){const t=s.data;p(Array.isArray(t)?t:[]),c(Array.isArray(t)?t:[])}},v=async()=>{const s=await o(T());if(s?.result){const t=s.data;u(Array.isArray(t)?t:[])}},y=async()=>{const s=await o(_());if(s?.result){const t=s.data;f(Array.isArray(t)?t:[])}},w=async()=>{const s=await o(R());if(s?.result){const t=s.data;j(Array.isArray(t)?t:[])}};r.useEffect(()=>{let s=n.filter(t=>{const l=a.input===""||t.fullName?.toLowerCase().includes(a.input.toLowerCase())||t.id?.toString().includes(a.input)||t.phone?.toString().includes(a.input),A=a.status===""||t.status===a.status;return l&&A});a.date==="ASC"?s=s.slice().sort((t,l)=>new Date(t.createdAt).getTime()-new Date(l.createdAt).getTime()):a.date==="DESC"&&(s=s.slice().sort((t,l)=>new Date(l.createdAt).getTime()-new Date(t.createdAt).getTime())),c(s)},[a,n]),r.useEffect(()=>{m(),v(),y(),w()},[]);const i={totalAppointments:n.length,pendingAppointments:n.filter(s=>s.status==="PENDING").length,confirmedAppointments:n.filter(s=>s.status==="CONFIRMED").length,cancelledAppointments:n.filter(s=>s.status==="CANCELLED").length,completedAppointments:n.filter(s=>s.status==="COMPLETED").length,todayAppointments:n.filter(s=>{const t=new Date().toDateString();return new Date(s.createdAt).toDateString()===t}).length};return e.jsx("main",{className:"appointments-page p-4 sm:p-6",children:e.jsxs("div",{className:"appointments-page__wrap max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-blue-700 mb-2 sm:mb-0",children:"Quản lý lịch hẹn"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Quản lý các lịch hẹn của khách hàng"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["Tổng: ",e.jsx("span",{className:"font-semibold text-blue-600",children:i.totalAppointments})," lịch hẹn"]}),e.jsxs("div",{children:["Hôm nay: ",e.jsx("span",{className:"font-semibold text-green-600",children:i.todayAppointments})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-calendar text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tổng lịch hẹn"}),e.jsx("p",{className:"text-lg font-semibold",children:i.totalAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-clock text-yellow-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Chờ xác nhận"}),e.jsx("p",{className:"text-lg font-semibold",children:i.pendingAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-check-circle text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Đã xác nhận"}),e.jsx("p",{className:"text-lg font-semibold",children:i.confirmedAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-calendar-check text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Hôm nay"}),e.jsx("p",{className:"text-lg font-semibold",children:i.todayAppointments})]})]})})]}),e.jsxs("div",{className:"appointments__sort bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6 grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"appointments__filter flex flex-col gap-3 sm:flex-row sm:items-center sm:space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"}),e.jsx("input",{type:"text",className:"border border-gray-300 rounded-md py-2 pl-10 pr-4 text-sm w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Tìm theo tên bệnh nhân hoặc id ...",value:a.input,onChange:s=>d("input",s.target.value)})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:a.status,onChange:s=>d("status",s.target.value),children:[e.jsx("option",{value:"",children:"Chọn trạng thái"}),S.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:a.date,onChange:s=>d("date",s.target.value),children:[e.jsx("option",{value:"",children:"Sắp xếp theo"}),C.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})})]}),e.jsx("div",{className:"appointments__options flex justify-end items-center",children:e.jsxs("button",{className:"font-semibold bg-blue-600 text-white hover:text-blue-600 hover:bg-white hover:ring-3 hover:ring-blue-600 px-4 py-2 rounded shadow cursor-pointer flex items-center",children:[e.jsx("i",{className:"fa-solid fa-plus me-2"}),e.jsx("span",{children:"Thêm lịch hẹn"})]})})]}),e.jsx("div",{className:"appointments__data hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(L,{appointments:x,departments:h,rooms:g,doctors:b,onSuccess:m})})})]})})};export{z as default};
