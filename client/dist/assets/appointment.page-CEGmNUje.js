import{u as j,r as i,j as e,c as v}from"./index-wOwRfMo4.js";import{a as w,d as A}from"./status.constant-BZ6KLHNH.js";import{T as D}from"./pagination-DByYZh53.js";import{A as C}from"./appointment.detail-DTfmW0OU.js";import{f as E}from"./format-date.util-D8g88DXU.js";import{c as b,a as S}from"./appointment.service-pkTqRrMy.js";const T=x=>{const{appointments:n,onSuccess:h}=x,{execute:p,notify:o}=j(),[l,u]=i.useState(1),[d,g]=i.useState(5),[c,s]=i.useState(!1),[a,r]=i.useState({}),f=t=>{r(t),s(!0)},N=async t=>{const m=await p(b(t.id,"COMPLETED"));o(m,"Đánh dấu hoàn thành thành công"),h?.()},y=async t=>{const m=await p(b(t.id,"CANCELLED"));o(m,"Hủy lịch hẹn thành công"),h?.()};return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"# ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Tên bệnh nhân"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Trạng thái phiếu"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Số điện thoại"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Thời gian hẹn"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Ngày tạo phiếu"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:n&&n.length>0?n.slice((l-1)*d,l*d).map((t,m)=>e.jsxs("tr",{className:`${m%2===0?"bg-gray-50":"bg-white"} hover:bg-blue-50 transition-colors`,children:[e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:["# ",t.id]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:t.fullName}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium 
                                    ${t.status==="PENDING"?"bg-yellow-100 text-yellow-800":""}
                                    ${t.status==="CONFIRMED"?"bg-green-100 text-green-700":""}
                                    ${t.status==="COMPLETED"?"bg-blue-100 text-blue-700":""}
                                    ${t.status==="CANCELLED"?"bg-red-100 text-red-700":""}
                                `,children:[t.status==="PENDING"?"Chưa xác nhận":"",t.status==="CONFIRMED"?"Đã xác nhận":"",t.status==="COMPLETED"?"Đã hoàn thành":"",t.status==="CANCELLED"?"Đã hủy":""]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:v(t.phone)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:t.time}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:E(new Date(t.createdAt))}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsxs("button",{className:"px-3 py-1 text-blue-600 border border-blue-300 rounded-md hover:bg-blue-50 transition-colors text-xs font-medium",onClick:()=>f(t),children:[e.jsx("i",{className:"fa-solid fa-eye mr-1"}),"Xem"]}),(t.status==="PENDING"||t.status==="CONFIRMED")&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"px-3 py-1 text-green-600 border border-green-300 rounded-md hover:bg-green-50 transition-colors text-xs font-medium",onClick:()=>N(t),children:[e.jsx("i",{className:"fa-solid fa-check mr-1"}),"Hoàn thành"]}),e.jsxs("button",{className:"px-3 py-1 text-red-600 border border-red-300 rounded-md hover:bg-red-50 transition-colors text-xs font-medium",onClick:()=>y(t),children:[e.jsx("i",{className:"fa-solid fa-times mr-1"}),"Hủy"]})]}),t.status==="COMPLETED"&&e.jsxs("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-md text-xs font-medium",children:[e.jsx("i",{className:"fa-solid fa-check-circle mr-1"}),"Hoàn thành"]}),t.status==="CANCELLED"&&e.jsxs("span",{className:"px-3 py-1 bg-red-100 text-red-700 rounded-md text-xs font-medium",children:[e.jsx("i",{className:"fa-solid fa-ban mr-1"}),"Đã hủy"]})]})})]},t.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"px-4 py-3 text-sm text-gray-600 text-center",children:e.jsxs("div",{className:"flex justify-center items-center gap-3",children:[e.jsx("i",{className:"fa-solid fa-inbox"}),e.jsx("span",{children:"Không tìm thấy dữ liệu"})]})})})})]}),e.jsx(D,{array:x.appointments,page:l,row:d,setPage:u,setRow:g}),c&&a&&e.jsx(C,{appointmentSelect:a,setShowDetail:s})]})},M=()=>{const{execute:x}=j(),[n,h]=i.useState([]),[p,o]=i.useState([]),[l,u]=i.useState({input:"",status:"",date:""}),d=(s,a)=>{u(r=>({...r,[s]:a}))},g=async()=>{const s=await x(S());if(s?.result){const a=s.data;h(Array.isArray(a)?a:[]),o(Array.isArray(a)?a:[])}};i.useEffect(()=>{let s=n.filter(a=>{const r=l.input===""||a.fullName?.toLowerCase().includes(l.input.toLowerCase())||a.id?.toString().includes(l.input)||a.phone?.toString().includes(l.input),f=l.status===""||a.status===l.status;return r&&f});l.date==="ASC"?s=s.slice().sort((a,r)=>new Date(a.createdAt).getTime()-new Date(r.createdAt).getTime()):l.date==="DESC"&&(s=s.slice().sort((a,r)=>new Date(r.createdAt).getTime()-new Date(a.createdAt).getTime())),o(s)},[l,n]),i.useEffect(()=>{g()},[]);const c={totalAppointments:n.length,confirmedAppointments:n.filter(s=>s.status==="CONFIRMED").length,completedAppointments:n.filter(s=>s.status==="COMPLETED").length,cancelledAppointments:n.filter(s=>s.status==="CANCELLED").length,todayAppointments:n.filter(s=>{const a=new Date().toDateString();return new Date(s.createdAt).toDateString()===a}).length};return e.jsx("main",{className:"appointments-page p-4 sm:p-6",children:e.jsxs("div",{className:"appointments-page__wrap max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-blue-700 mb-2 sm:mb-0",children:"Quản lý lịch hẹn bác sĩ"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Danh sách lịch hẹn khám của bác sĩ"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["Tổng: ",e.jsx("span",{className:"font-semibold text-blue-600",children:c.totalAppointments})," lịch hẹn"]}),e.jsxs("div",{children:["Hôm nay: ",e.jsx("span",{className:"font-semibold text-green-600",children:c.todayAppointments})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-calendar text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tổng lịch hẹn"}),e.jsx("p",{className:"text-lg font-semibold",children:c.totalAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-check-circle text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Đã xác nhận"}),e.jsx("p",{className:"text-lg font-semibold",children:c.confirmedAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-user-check text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Hoàn thành"}),e.jsx("p",{className:"text-lg font-semibold",children:c.completedAppointments})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-ban text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Đã hủy"}),e.jsx("p",{className:"text-lg font-semibold",children:c.cancelledAppointments})]})]})})]}),e.jsxs("div",{className:"appointments__sort bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6 grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"appointments__filter flex flex-col gap-3 sm:flex-row sm:items-center sm:space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"}),e.jsx("input",{type:"text",className:"border border-gray-300 rounded-md py-2 pl-10 pr-4 text-sm w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Tìm theo tên bệnh nhân, ID hoặc SĐT...",value:l.input,onChange:s=>d("input",s.target.value)})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.status,onChange:s=>d("status",s.target.value),children:[e.jsx("option",{value:"",children:"Tất cả trạng thái"}),w.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.date,onChange:s=>d("date",s.target.value),children:[e.jsx("option",{value:"",children:"Sắp xếp theo ngày"}),A.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})})]}),e.jsx("div",{className:"appointments__options flex justify-end items-center gap-2",children:e.jsxs("button",{className:"font-semibold bg-green-600 text-white hover:text-green-600 hover:bg-white hover:ring-3 hover:ring-green-600 px-4 py-2 rounded shadow cursor-pointer flex items-center",onClick:()=>window.location.href="/doctor/create-invoice",children:[e.jsx("i",{className:"fa-solid fa-receipt me-2"}),e.jsx("span",{children:"Tạo hóa đơn"})]})})]}),e.jsx("div",{className:"appointments__data hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(T,{appointments:p,onSuccess:g})})})]})})};export{M as default};
