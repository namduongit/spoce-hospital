import{u as C,r as d,j as e,c as I}from"./index-wOwRfMo4.js";import{T as k}from"./pagination-DByYZh53.js";import{A as D}from"./appointment.detail-DTfmW0OU.js";import{a as A}from"./status.constant-BZ6KLHNH.js";import{u as $,d as L}from"./appointment.service-pkTqRrMy.js";import{f as T}from"./format-date.util-D8g88DXU.js";const P=h=>{const{appointmentSelect:a,setShowEdit:u,departments:b,rooms:f,doctors:g,onSuccess:p}=h,{execute:y,notify:j,loading:i}=C(),[l,c]=d.useState(!1),[n,x]=d.useState({phone:"",departmentId:"",doctorId:"",roomId:"",time:"",note:"",status:""}),r=(t,o)=>{x(v=>({...v,[t]:o}))},N=async t=>{t.preventDefault();const o=await y($(a.id,n));j(o,"Cập nhật lịch khám thành công"),o?.result&&(p?.(),u(!1))},m=()=>{x({phone:"",departmentId:"",doctorId:"",roomId:"",time:"",note:"",status:""}),u(!1)};return d.useEffect(()=>{x({phone:a.phone,departmentId:a.departmentId?.toString(),doctorId:a.doctorId?.toString(),roomId:a.roomId?.toString(),time:a.time,note:a.note,status:a.status}),c(a.status=="COMPLETED"||a.status=="CANCELLED")},[a]),e.jsx("div",{className:"fixed top-0 start-0 bg-gray-400/60 w-full h-full z-10 flex justify-center items-center",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Sửa lịch khám - # ",a.id]}),e.jsx("button",{onClick:m,className:"text-gray-500 hover:text-gray-700 text-xl",children:"x"})]}),e.jsxs("form",{className:"space-y-4",onSubmit:N,children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Họ tên bệnh nhân"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",className:"w-full px-3 py-2 border text-gray-600 border-gray-300 bg-gray-50 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!0,value:a.fullName})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số điện thoại"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"text",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.phone,onChange:t=>r("phone",t.target.value)})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Khoa khám"}),e.jsxs("select",{name:"role",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.departmentId,onChange:t=>r("departmentId",t.target.value),children:[e.jsx("option",{value:"",children:"Chọn khoa khám"}),b.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Trạng thái"}),e.jsxs("select",{name:"role",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.status,onChange:t=>r("status",t.target.value),children:[e.jsx("option",{value:"",children:"Chọn trạng thái"}),A.map(t=>e.jsx("option",{value:t.value,children:t.name},t.id))]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bác sĩ"}),e.jsxs("select",{name:"role",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.doctorId,onChange:t=>r("doctorId",t.target.value),children:[e.jsx("option",{value:"",children:"Chọn bác sĩ"}),g.map(t=>e.jsx("option",{value:t.id,children:t.fullName},t.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phòng khám"}),e.jsxs("select",{name:"role",className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.roomId,onChange:t=>r("roomId",t.target.value),children:[e.jsx("option",{value:"",children:"Chọn phòng khám"}),f.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Thời gian"}),e.jsx("div",{className:"relative",children:e.jsx("input",{className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,value:n.time,onChange:t=>r("time",t.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi chú"}),e.jsx("textarea",{className:`w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500
                                    ${l?"bg-gray-50":"bg-white"}`,disabled:l,rows:3,value:n.note,onChange:t=>r("note",t.target.value)})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",className:"flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition",onClick:m,children:"Hủy"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50",disabled:i,children:i?"Đang cập nhật...":"Lưu thay đổi"})]})]})]})})},K=h=>{const{appointments:a,departments:u,rooms:b,doctors:f,onSuccess:g}=h,{execute:p,notify:y,doFunc:j}=C(),[i,l]=d.useState(1),[c,n]=d.useState(5),[x,r]=d.useState(!1),[N,m]=d.useState(!1),[t,o]=d.useState({}),v=s=>{o(s),r(!0)},S=s=>{o(s),m(!0)},E=async s=>{const w=await p(L(s.id));y(w,"Xóa lịch hẹn thành công"),j(()=>{g?.()})};return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"# ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Tên bệnh nhân"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Trạng thái phiếu"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Số điện thoại"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Ngày tạo phiếu"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:a&&a.length>0?a.slice((i-1)*c,i*c).map((s,w)=>e.jsxs("tr",{className:`${w%2===0?"bg-gray-50":"bg-white"} hover:bg-blue-50 transition-colors`,children:[e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:["# ",s.id]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:s.fullName}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium 
                                                                            ${s.status==="PENDING"?"bg-yellow-100 text-yellow-800":""}
                                                                            ${s.status==="CONFIRMED"?"bg-green-100 text-green-700":""}
                                                                            ${s.status==="COMPLETED"?"bg-blue-100 text-blue-700":""}
                                                                            ${s.status==="CANCELLED"?"bg-red-100 text-red-700":""}
                                                                        `,children:[s.status==="PENDING"?"Chưa xác nhận":"",s.status==="CONFIRMED"?"Đã xác nhận":"",s.status==="COMPLETED"?"Đã hoàn thành":"",s.status==="CANCELLED"?"Đã hủy":""]})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:I(s.phone)}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-900 font-medium",children:T(new Date(s.createdAt))}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>v(s),children:e.jsx("i",{className:"fa-solid fa-info"})}),e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>S(s),children:e.jsx("i",{className:"fa-solid fa-wrench"})}),e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>E(s),children:e.jsx("i",{className:"fa-solid fa-trash"})})]})})]},s.id)):e.jsx(e.Fragment,{children:e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-4 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("i",{className:"fa-solid fa-calendar-check text-4xl mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"Không có lịch hẹn nào"}),e.jsx("p",{className:"text-sm mt-1",children:"Chưa có dữ liệu để hiển thị"})]})})})})})]}),e.jsx(k,{array:h.appointments,page:i,row:c,setPage:l,setRow:n}),x&&t&&e.jsx(D,{appointmentSelect:t,setShowDetail:r}),N&&t&&e.jsx(P,{appointmentSelect:t,setShowEdit:m,departments:u,rooms:b,doctors:f,onSuccess:g})]})};export{K as A};
