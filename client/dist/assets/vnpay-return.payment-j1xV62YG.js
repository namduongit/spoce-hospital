import{u as v,a as y,v as j,r as n,j as e,f as b}from"./index-wOwRfMo4.js";import{f as C}from"./payment.service-CcC8hpiP.js";import{r as T}from"./receipt-Cm8uC6Ar.js";const S=()=>{const{execute:x,notify:f}=v(),i=y(),[t]=j(),[c,u]=n.useState(!0),[d,m]=n.useState(""),[l,h]=n.useState(!1),[s,p]=n.useState({amount:"",bankCode:"",bankTranNo:"",cardType:"",orderInfo:"",payDate:"",responseCode:"",tmnCode:"",transactionNo:"",transactionStatus:"",txnRef:"",secureHash:""}),[r,g]=n.useState(10),N=async()=>{const a=await x(C(s));if(f(a,"Thanh toán thành công"),a?.result){const o=a.data;m(o.directUrl),h(o.paid)}else{const o=s.orderInfo.includes("PRESCRIPTION INVOICE")?"/prescription-invoices":"/service-invoices";m(i.role!="USER"&&i.role!="DOCTOR"?i.role?.toLocaleLowerCase()+o:"/"),h(!1)}};return n.useEffect(()=>{const a={amount:t.get("vnp_Amount")||"",bankCode:t.get("vnp_BankCode")||"",bankTranNo:t.get("vnp_BankTranNo")||"",cardType:t.get("vnp_CardType")||"",orderInfo:t.get("vnp_OrderInfo")||"",payDate:t.get("vnp_PayDate")||"",responseCode:t.get("vnp_ResponseCode")||"",tmnCode:t.get("vnp_TmnCode")||"",transactionNo:t.get("vnp_TransactionNo")||"",transactionStatus:t.get("vnp_TransactionStatus")||"",txnRef:t.get("vnp_TxnRef")||"",secureHash:t.get("vnp_SecureHash")||""};p(a),u(!1)},[t]),n.useEffect(()=>{!c&&N()},[s]),n.useEffect(()=>{if(!c&&r>0){const a=setTimeout(()=>{g(r-1)},1e3);return()=>clearTimeout(a)}else r===0&&!c&&(window.location.href=d)},[r,c]),e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:[e.jsxs("div",{className:"container bg-white rounded-md shadow-lg p-6 max-w-xl",children:[e.jsx("img",{src:T,alt:"Receipt",className:"w-20 h-20 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-1 text-center",children:"Kết quả thanh toán VNPay"}),!c&&e.jsx("p",{className:`${l?"text-green-600":"text-red-600"} text-md font-medium mb-4 text-center`,children:l?"Thanh toán thành công":"Hóa đơn đã được thanh toán hoặc hủy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Mã giao dịch:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:s.transactionNo})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Nội dung thanh toán:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:s.orderInfo})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Ngày thanh toán:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:s.payDate})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Mã ngân hàng:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:s.bankCode})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Số tiền:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:b(Number(s.amount)/100)})]}),!l&&e.jsx("div",{className:"px-2 py-2 bg-yellow-50 border-s-3 border-yellow-500 rounded",children:e.jsx("p",{className:"text-yellow-700 text-sm",children:"Lưu ý: Hóa đơn này đã được thanh toán hoặc đã bị hủy. Vui lòng kiểm tra lại lịch sử giao dịch của bạn."})}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("p",{className:"text-gray-600",children:"Cảm ơn bạn đã sử dụng dịch vụ của chúng tôi!"})})]})]}),e.jsxs("div",{className:"mt-3 text-center",children:[!c&&e.jsxs("p",{className:"text-gray-500 text-sm mt-4",children:["Trang sẽ tự động chuyển hướng trong ",r," giây..."]}),e.jsx("span",{className:"text-blue-500 text-sm cursor-pointer underline",onClick:()=>window.location.href=d,children:"Trở về ngay"})]})]})};export{S as default};
