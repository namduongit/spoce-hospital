import{u as N,a as j,v,r as a,j as e,f as I}from"./index-wOwRfMo4.js";import{g as T}from"./payment.service-CcC8hpiP.js";import{r as b}from"./receipt-Cm8uC6Ar.js";const S=()=>{const{execute:x,notify:u}=N(),o=j(),[s]=v(),[r,f]=a.useState(!0),[l,m]=a.useState(""),[d,h]=a.useState(!1),[t,g]=a.useState({partnerCode:"",orderId:"",requestId:"",amount:"",orderInfo:"",orderType:"",transId:"",resultCode:"",message:"",payType:"",responseTime:"",extraData:"",signature:""}),[i,p]=a.useState(10),y=async()=>{const n=await x(T(t));if(u(n,"Thanh toán thành công"),n?.result){const c=n.data;m(c.directUrl),h(c.paid)}else{const c=t.orderInfo.includes("PRESCRIPTION INVOICE")?"/prescription-invoices":"/service-invoices";m(o.role!="USER"&&o.role!="DOCTOR"?o.role?.toLocaleLowerCase()+c:"/"),h(!1)}};return a.useEffect(()=>{const n={partnerCode:s.get("partnerCode")||"",orderId:s.get("orderId")||"",requestId:s.get("requestId")||"",amount:s.get("amount")||"",orderInfo:s.get("orderInfo")||"",orderType:s.get("orderType")||"",transId:s.get("transId")||"",resultCode:s.get("resultCode")||"",message:s.get("message")||"",payType:s.get("payType")||"",responseTime:s.get("responseTime")||"",extraData:s.get("extraData")||"",signature:s.get("signature")||""};g(n),f(!1)},[s]),a.useEffect(()=>{!r&&y()},[t]),a.useEffect(()=>{if(!r&&i>0){const n=setTimeout(()=>{p(i-1)},1e3);return()=>clearTimeout(n)}else i===0&&!r&&(window.location.href=l)},[i,r]),e.jsxs("div",{className:"w-full min-h-screen flex flex-col items-center justify-center bg-gray-100 p-4",children:[e.jsxs("div",{className:"container bg-white rounded-md shadow-lg p-6 max-w-xl",children:[e.jsx("img",{src:b,alt:"Receipt",className:"w-20 h-20 mx-auto mb-4"}),e.jsx("h2",{className:"text-2xl font-semibold mb-1 text-center",children:"Kết quả thanh toán Momo"}),!r&&e.jsx("p",{className:`${d?"text-green-600":"text-red-600"} text-md font-medium mb-4 text-center`,children:d?"Thanh toán thành công":"Hóa đơn đã được thanh toán hoặc hủy"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Mã giao dịch:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:t.transId})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Mã đơn hàng:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:t.orderId})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Nội dung thanh toán:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:t.orderInfo})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Thời gian thanh toán:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:t.responseTime?new Date(Number(t.responseTime)).toLocaleString("vi-VN"):""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Loại thanh toán:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:t.payType})]}),e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-1",children:"Số tiền:"}),e.jsx("div",{className:"text-gray-700 font-medium",children:I(Number(t.amount))})]}),!d&&e.jsx("div",{className:"px-2 py-2 bg-yellow-50 border-s-3 border-yellow-500 rounded",children:e.jsx("p",{className:"text-yellow-700 text-sm",children:"Lưu ý: Hóa đơn này đã được thanh toán hoặc đã bị hủy. Vui lòng kiểm tra lại lịch sử giao dịch của bạn."})}),e.jsx("div",{className:"mt-4 text-center text-sm",children:e.jsx("p",{className:"text-gray-600",children:"Cảm ơn bạn đã sử dụng dịch vụ của chúng tôi!"})})]})]}),e.jsxs("div",{className:"mt-3 text-center",children:[!r&&e.jsxs("p",{className:"text-gray-500 text-sm mt-4",children:["Trang sẽ tự động chuyển hướng trong ",i," giây..."]}),e.jsx("span",{className:"text-blue-500 text-sm cursor-pointer underline",onClick:()=>window.location.href=l,children:"Trở về ngay"})]})]})};export{S as default};
