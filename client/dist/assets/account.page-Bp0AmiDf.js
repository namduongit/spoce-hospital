import{u as v,r as i,j as e}from"./index-wOwRfMo4.js";import{c as C}from"./status.constant-BZ6KLHNH.js";import{c as A,u as k,g as T}from"./account.service-mdvzvQaG.js";import{T as I}from"./pagination-DByYZh53.js";const N=[{id:1,name:"Người dùng",value:"USER"},{id:2,name:"Nhân viên",value:"ASSISTOR"},{id:3,name:"Bác sĩ",value:"DOCTOR"},{id:4,name:"Quản trị viên",value:"ADMIN"}],E=h=>{const{setIsOpenCreateAccount:a,onSuccess:o}=h,{execute:f,notify:g,loading:d}=v(),[x,l]=i.useState({email:"",password:"",passwordConfirm:"",role:""}),[p,u]=i.useState(!1),[m,c]=i.useState(!1),s=(r,j)=>{l(w=>({...w,[r]:j}))},t=()=>{l({email:"",password:"",passwordConfirm:"",role:"USER"}),a(!1)},b=async r=>{r.preventDefault();const j=await f(A(x));g(j,"Tạo tài khoản thành công"),j?.result&&(t(),o?.())};return e.jsx("div",{className:"fixed inset-0 bg-gray-500/50 bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Tạo tài khoản mới"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 text-xl",children:"x"})]}),e.jsxs("form",{className:"space-y-4",onSubmit:b,children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"email",name:"email",value:x.email,onChange:r=>s("email",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập email",required:!0})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:p?"text":"password",name:"password",value:x.password,onChange:r=>s("password",r.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập mật khẩu",required:!0}),e.jsx("button",{type:"button",onClick:()=>u(!p),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx("i",{className:`fa-solid ${p?"fa-eye-slash":"fa-eye"}`})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Xác nhận mật khẩu *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",name:"passwordConfirm",value:x.passwordConfirm,onChange:r=>s("passwordConfirm",r.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nhập lại mật khẩu",required:!0}),e.jsx("button",{type:"button",onClick:()=>c(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:e.jsx("i",{className:`fa-solid ${m?"fa-eye-slash":"fa-eye"}`})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Vai trò *"}),e.jsxs("select",{name:"role",value:x.role,onChange:r=>s("role",r.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,children:[e.jsx("option",{value:"",children:"Chọn vai trò"}),N.map(r=>e.jsx("option",{value:r.value,children:r.name},r.id))]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition",children:"Hủy"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition disabled:opacity-50",children:d?"Đang thêm...":"Thêm tài khoản"})]})]})]})})},R=h=>{const{accountSelect:a,setShowDetail:o}=h,f=d=>d==="ACTIVE"?"text-green-600 bg-green-100":"text-red-600 bg-red-100",g=d=>{switch(d){case"ADMIN":return"text-purple-600 bg-purple-100";case"DOCTOR":return"text-blue-600 bg-blue-100";case"CASHIER":return"text-orange-600 bg-orange-100";case"USER":return"text-gray-600 bg-gray-100";default:return"text-gray-600 bg-gray-100"}};return e.jsx("div",{className:"fixed inset-0 bg-gray-500/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-circle text-blue-600"}),"Chi tiết tài khoản #",a.id]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"x"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-info-circle text-blue-600"}),"Thông tin cơ bản"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Email"}),e.jsx("p",{className:"text-gray-900",children:a.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Loại tài khoản"}),e.jsx("p",{className:"text-gray-900",children:a.type==="ACCOUNT"?"Tài khoản":"Email"})]})]})]}),e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[e.jsx("i",{className:"fa-solid fa-user-tag text-green-600"}),"Vai trò và trạng thái"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Vai trò"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g(a.role)}`,children:a.role==="ADMIN"?"Quản trị viên":a.role==="DOCTOR"?"Bác sĩ":a.role==="ASSISTOR"?"Nhân viên":"Khách hàng"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 mb-1",children:"Trạng thái"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${f(a.status)}`,children:a.status==="INACTIVE"?"Bị khóa":"Đang hoạt động"})]})]})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>o(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition",children:"Đóng"})})]})})},D=h=>{const{accountSelect:a,setShowEdit:o,onSuccess:f}=h,{execute:g,notify:d,loading:x}=v(),[l,p]=i.useState(!1),[u,m]=i.useState({password:"",role:"",status:""}),c=(t,b)=>{m(r=>({...r,[t]:b}))},s=async()=>{const t=await g(k(a.id,u));d(t,"Cập nhật thông tin thành công"),t?.result&&(o(!1),f?.())};return i.useEffect(()=>{m({password:"",role:a.role,status:a.status})},[a]),e.jsx("div",{className:"fixed top-0 start-0 w-full h-full bg-gray-400/60 flex items-center justify-center z-20",children:e.jsxs("div",{className:"bg-white w-100 rounded-lg shadow-lg p-6 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:["Sửa thông tin tài khoản - # ",a.id]}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700 text-xl",children:"x"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email"}),e.jsx("input",{type:"text",readOnly:!0,value:a.email,className:"w-full border border-gray-300 rounded px-3 py-2 bg-gray-50 text-gray-700"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Mật khẩu mới:"}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:`fa-solid ${l?"fa-eye":"fa-eye-slash"} absolute top-1/2 -translate-y-1/2 end-3 text-gray-400 cursor-pointer`,onClick:()=>p(!l)}),e.jsx("input",{type:l?"text":"password",required:!0,value:u.password,placeholder:"Nhập mật khẩu mới",onChange:t=>c("password",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Vai trò:"}),e.jsxs("select",{value:u.role,required:!0,onChange:t=>c("role",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Chọn vai trò"}),N&&N.map(t=>e.jsx("option",{value:t.value,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Trạng thái:"}),e.jsxs("select",{value:u.status,required:!0,onChange:t=>c("role",t.target.value),className:"w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Chọn trạng thái"}),C&&C.map(t=>e.jsx("option",{value:t.value,children:t.name},t.id))]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{className:"flex-1 px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50 transition",onClick:()=>o(!1),children:"Hủy"}),e.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 flex-1",onClick:s,disabled:x,children:x?"Đang xử lý...":"Xác nhận"})]})]})})},O=h=>{const{accounts:a,onSuccess:o}=h,{execute:f,notify:g}=v(),[d,x]=i.useState(1),[l,p]=i.useState(5),[u,m]=i.useState(!1),[c,s]=i.useState(!1),[t,b]=i.useState({}),r=n=>{b(n),m(!0)},j=n=>{b(n),s(!0)},w=async(n,y)=>{const S=await f(k(n.id,{status:y}));g(S,y==="INACTIVE"?"Khóa tài khoản thành công":"Mở khóa tài khoản thành công"),S?.result&&o?.()};return e.jsxs(e.Fragment,{children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-blue-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"# ID"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Tài khoản"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Trạng thái"}),e.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"Quyền hạn"}),e.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"Hành động"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:a&&a.length>0?a.slice((d-1)*l,d*l).map((n,y)=>e.jsxs("tr",{className:`${y%2===0?"bg-gray-50":"bg-white"} hover:bg-blue-50 transition-colors`,children:[e.jsxs("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:["# ",n.id]}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-700 font-medium",children:n.email}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:`inline-flex px-2 py-1 rounded-full text-xs font-medium 
                                                                            ${n.status==="INACTIVE"?"bg-yellow-100 text-yellow-800":""}
                                                                            ${n.status==="ACTIVE"?"bg-green-100 text-green-700":""}
                                                                        `,children:n.status==="INACTIVE"?"Tạm khóa":"Họat động"})}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:n.role==="ADMIN"?"Quản trị viên":n.role==="DOCTOR"?"Bác sĩ":n.role==="ASSISTOR"?"Nhân viên":"Khách hàng"}),e.jsx("td",{className:"px-4 py-3 text-sm text-gray-600 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>r(n),children:e.jsx("i",{className:"fa-solid fa-info"})}),e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>j(n),children:e.jsx("i",{className:"fa-solid fa-wrench"})}),e.jsx("button",{className:"px-0.75 py-0.75 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",onClick:()=>{w(n,n.status==="ACTIVE"?"INACTIVE":"ACTIVE")},children:e.jsx("i",{className:`fa-solid ${n.status==="ACTIVE"?"fa-lock":"fa-lock-open"}`})})]})})]},n.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-4 py-8 text-center text-gray-500",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("i",{className:"fa-solid fa-users text-4xl mb-3 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium",children:"Không có tài khoản nào"}),e.jsx("p",{className:"text-sm mt-1",children:"Chưa có dữ liệu để hiển thị"})]})})})})]}),e.jsx(I,{array:h.accounts,page:d,row:l,setPage:x,setRow:p}),u&&t&&e.jsx(R,{accountSelect:t,setShowDetail:m,onSuccess:o}),c&&t&&e.jsx(D,{accountSelect:t,setShowEdit:s,onSuccess:o})]})},M=()=>{const{execute:h}=v(),[a,o]=i.useState([]),[f,g]=i.useState([]),[d,x]=i.useState(!1),[l,p]=i.useState({input:"",role:"",status:""}),u=(s,t)=>{p(b=>({...b,[s]:t}))},m=async()=>{const s=await h(T());if(s?.result){const t=s.data;o(t),g(t)}};i.useEffect(()=>{g(a.filter(s=>{const t=l.input===""||s.email?.toLowerCase().includes(l.input.toLowerCase())||s.id?.toString().includes(l.input),b=l.role===""||s.role===l.role,r=l.status===""||s.status===l.status;return t&&b&&r}))},[l,a]),i.useEffect(()=>{m()},[]);const c={totalAccounts:a.length,activeAccounts:a.filter(s=>s.status==="ACTIVE").length,inactiveAccounts:a.filter(s=>s.status==="INACTIVE").length,adminAccounts:a.filter(s=>s.role==="ADMIN").length,doctorAccounts:a.filter(s=>s.role==="DOCTOR").length,assistorAccounts:a.filter(s=>s.role==="ASSISTOR").length,patientAccounts:a.filter(s=>s.role==="USER").length};return e.jsxs("main",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-blue-700 mb-2 sm:mb-0",children:"Quản lý tài khoản"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Quản lý các tài khoản trong hệ thống"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["Tổng: ",e.jsx("span",{className:"font-semibold text-blue-600",children:c.totalAccounts})," tài khoản"]}),e.jsxs("div",{children:["Hoạt động: ",e.jsx("span",{className:"font-semibold text-green-600",children:c.activeAccounts})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-users text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tổng tài khoản"}),e.jsx("p",{className:"text-lg font-semibold",children:c.totalAccounts})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-check-circle text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Hoạt động"}),e.jsx("p",{className:"text-lg font-semibold",children:c.activeAccounts})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-user-md text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Bác sĩ"}),e.jsx("p",{className:"text-lg font-semibold",children:c.doctorAccounts})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-user text-orange-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Nhân viên"}),e.jsx("p",{className:"text-lg font-semibold",children:c.assistorAccounts})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-user text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Bệnh nhân"}),e.jsx("p",{className:"text-lg font-semibold",children:c.patientAccounts})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6 grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Tìm kiếm"}),e.jsxs("div",{className:"relative",children:[e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"}),e.jsx("input",{value:l.input,onChange:s=>u("input",s.target.value),type:"text",className:"border border-gray-300 rounded-md py-2 pl-10 pr-4 text-sm w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Tìm theo tên tài khoản hoặc id ..."})]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Chọn quyền"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.role,onChange:s=>u("role",s.target.value),children:[e.jsx("option",{value:"",children:"Chọn quyền"}),N.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Chọn trạng thái"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.status,onChange:s=>u("status",s.target.value),children:[e.jsx("option",{value:"",children:"Chọn trạng thái"}),C.map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})]})]}),e.jsx("div",{className:"flex justify-end items-center gap-2",children:e.jsxs("button",{className:"font-semibold bg-blue-600 text-white hover:text-blue-600 hover:bg-white hover:ring-3 hover:ring-blue-600 px-4 py-2 rounded shadow cursor-pointer flex items-center",onClick:()=>x(!0),children:[e.jsx("i",{className:"fa-solid fa-plus me-2"}),e.jsx("span",{children:"Thêm tài khoản"})]})})]}),e.jsx("div",{className:"hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsx(O,{accounts:f,onSuccess:m})})})]}),d&&e.jsx(E,{setIsOpenCreateAccount:x,onSuccess:m})]})};export{M as default};
