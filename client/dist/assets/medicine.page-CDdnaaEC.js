import{u as M,r as i,j as e}from"./index-wOwRfMo4.js";import{m as k,a as L}from"./medicine.constant-CpMBuXEb.js";import{M as T,a as F,A as O,b as A}from"./medicine-category.add-Y-MagQaS.js";import{g as I,a as E}from"./medicine.service-Cwwuf_rk.js";import"./pagination-DByYZh53.js";const H=()=>{const{execute:x}=M(),[c,b]=i.useState("medicine"),[a,j]=i.useState([]),[v,u]=i.useState([]),[n,N]=i.useState([]),[w,h]=i.useState([]),[y,g]=i.useState(!1),[C,p]=i.useState(!1),[l,S]=i.useState({input:"",status:""}),f=(s,t)=>{S(m=>({...m,[s]:t}))},d=async()=>{const s=await x(I());if(s?.result){const t=s.data;N(t),h(t)}},o=async()=>{const s=await x(E());if(s?.result){const t=s.data;j(t),u(t)}};i.useEffect(()=>{c==="medicine"?u(a.filter(s=>{const t=l.input===""||s.name?.toLowerCase().includes(l.input.toLowerCase())||s.id?.toString().includes(l.input)||s.categoryName?.toLowerCase().includes(l.input.toLowerCase()),m=l.status===""||s.status===l.status;return t&&m})):h(n.filter(s=>l.input===""||s.name?.toLowerCase().includes(l.input.toLowerCase())||s.id?.toString().includes(l.input)))},[l,a,n,c]),i.useEffect(()=>{d(),o()},[]);const r={totalMedicines:a.length,totalCategories:n.length,activeMedicines:a.filter(s=>s.status==="active").length,inactiveMedicines:a.filter(s=>s.status==="inactive").length,outOfStockMedicines:a.filter(s=>s.status==="out_of_stock").length,lowStockMedicines:a.filter(s=>s.currentStock<=s.minStock).length,totalCurrentStock:a.reduce((s,t)=>s+(t.currentStock||0),0),averagePrice:a.length>0?a.reduce((s,t)=>s+(t.price||0),0)/a.length:0,totalValue:a.reduce((s,t)=>s+(t.price*t.currentStock||0),0)};return e.jsxs("main",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"max-w-full",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-blue-700 mb-2 sm:mb-0",children:"Quản lý thuốc & loại thuốc"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Quản lý các thuốc và loại thuốc trong bệnh viện"})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsxs("div",{children:["Tổng: ",e.jsx("span",{className:"font-semibold text-blue-600",children:r.totalMedicines})," thuốc"]}),e.jsxs("div",{children:["Tổng: ",e.jsx("span",{className:"font-semibold text-blue-600",children:r.totalCategories})," loại thuốc"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-pills text-blue-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tổng thuốc"}),e.jsx("p",{className:"text-lg font-semibold",children:r.totalMedicines})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-tags text-purple-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Loại thuốc"}),e.jsx("p",{className:"text-lg font-semibold",children:r.totalCategories})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-check-circle text-green-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Đang hoạt động"}),e.jsx("p",{className:"text-lg font-semibold",children:r.activeMedicines})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-exclamation-triangle text-red-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Hết hàng"}),e.jsx("p",{className:"text-lg font-semibold",children:r.outOfStockMedicines})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-exclamation-circle text-yellow-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Sắp hết"}),e.jsx("p",{className:"text-lg font-semibold",children:r.lowStockMedicines})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:e.jsx("i",{className:"fa-solid fa-box text-orange-600"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Tồn kho"}),e.jsx("p",{className:"text-lg font-semibold",children:r.totalCurrentStock.toLocaleString()})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6 grid gap-4 grid-cols-1 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:space-x-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("i",{className:"fa-solid fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"}),e.jsx("input",{type:"text",value:l.input,onChange:s=>f("input",s.target.value),className:"border border-gray-300 rounded-md py-2 pl-10 pr-4 text-sm w-full focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Tìm kiếm theo tên hoặc id ..."})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:l.status,onChange:s=>f("status",s.target.value),children:[e.jsx("option",{value:"",children:"Chọn trạng thái"}),(c==="medicine"?k:L).map(s=>e.jsx("option",{value:s.value,children:s.name},s.id))]})}),e.jsx("div",{className:"flex-1",children:e.jsxs("select",{className:"w-full border border-gray-300 rounded-md py-2 px-3 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",value:c,onChange:s=>b(s.target.value),children:[e.jsx("option",{value:"medicine",children:"Quản lý thuốc"}),e.jsx("option",{value:"category",children:"Quản lý loại thuốc"})]})})]}),e.jsxs("div",{className:"flex justify-end items-center gap-2",children:[e.jsxs("button",{className:"font-semibold bg-blue-600 text-white hover:text-blue-600 hover:bg-white hover:ring-3 hover:ring-blue-600 px-4 py-2 rounded shadow cursor-pointer flex items-center",onClick:()=>g(!0),children:[e.jsx("i",{className:"fa-solid fa-plus me-2"}),e.jsx("span",{children:"Thêm thuốc"})]}),e.jsxs("button",{className:"font-semibold bg-blue-600 text-white hover:text-blue-600 hover:bg-white hover:ring-3 hover:ring-blue-600 px-4 py-2 rounded shadow cursor-pointer flex items-center",onClick:()=>p(!0),children:[e.jsx("i",{className:"fa-solid fa-plus me-2"}),e.jsx("span",{children:"Thêm loại thuốc"})]})]})]}),e.jsx("div",{className:"hidden lg:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:e.jsxs("div",{className:"overflow-x-auto",children:[c==="medicine"&&e.jsx(T,{medicines:v,categories:n,onSuccess:o}),c==="category"&&e.jsx(F,{categories:w,onSuccess:d})]})})]}),y&&e.jsx(O,{onClose:()=>g(!1),categories:n,onSuccess:o}),C&&e.jsx(A,{onClose:()=>p(!1),onSuccess:d})]})};export{H as default};
